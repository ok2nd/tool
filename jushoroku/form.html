<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>住所録・年賀状宛名印刷ファイル生成ツール</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #c8e6c9 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 40px;
        }
        h1 {
            color: #2c3e50;
            font-size: 28px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 4px;
        }
        .info-box h3 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .info-box ul {
            list-style: none;
            padding-left: 20px;
        }
        .info-box li {
            color: #37474f;
            margin: 8px 0;
            position: relative;
        }
        .info-box li:before {
            content: "✓";
            position: absolute;
            left: -20px;
            color: #4caf50;
            font-weight: bold;
        }
        .button-group {
            margin-bottom: 30px;
        }
        button {
            width: 100%;
            background: #4caf50;
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 15px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        button:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        button:active {
            transform: translateY(0);
        }
        .btn-blue {
            background: #2196f3;
        }
        .btn-blue:hover {
            background: #1976d2;
        }
        .status {
            background: #e8f5e9;
            border: 1px solid #4caf50;
            padding: 20px;
            border-radius: 8px;
            color: #2e7d32;
            font-weight: 500;
            white-space: pre-line;
            display: none;
        }
        .status.show {
            display: block;
        }
        .steps {
            background: #f5f5f5;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
        }
        .steps h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
        }
        .steps ol {
            padding-left: 25px;
        }
        .steps li {
            color: #37474f;
            margin: 15px 0;
            line-height: 1.6;
        }
        .steps strong {
            color: #1976d2;
        }
        .hint {
            background: #fff8e1;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .hint p {
            color: #f57c00;
            font-size: 14px;
            line-height: 1.6;
        }
        .icon {
            display: inline-block;
            width: 24px;
            height: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <span class="icon">📊</span>
            住所録・年賀状宛名印刷ファイル生成ツール
        </h1>

        <div class="info-box">
            <h3>📦 このツールで生成されるファイル：</h3>
            <ul>
                <li><strong>住所録.csv</strong> - 住所データ管理用（サンプルデータ付き）</li>
                <li><strong>差出人情報.csv</strong> - 差出人データ管理用</li>
                <li><strong>Word差し込み印刷_設定手順書.txt</strong> - 詳細な設定手順</li>
            </ul>
        </div>

        <div class="button-group">
            <button onclick="generateExcel()">
                <span class="icon">📊</span>
                Excelファイル（CSV）をダウンロード
            </button>

            <button onclick="generateWordInstructions()" class="btn-blue">
                <span class="icon">📝</span>
                Word設定手順書をダウンロード
            </button>
        </div>

        <div id="status" class="status"></div>

        <div class="steps">
            <h2>📝 次のステップ</h2>
            <ol>
                <li><strong>住所録.csv</strong>をExcelで開き、<strong>住所録.xlsx</strong>として保存</li>
                <li><strong>差出人情報.csv</strong>も同様にExcel形式で保存</li>
                <li>各列にデータ入力規則を設定（手順書参照）</li>
                <li>住所データを入力</li>
                <li>Wordで新規文書を作成し、<strong>差し込み印刷</strong>を設定（手順書参照）</li>
                <li>印刷したい宛先の「チェック」列に<strong>▲</strong>を入力</li>
                <li>Wordでフィルター設定後、印刷実行</li>
            </ol>
        </div>

        <div class="hint">
            <p><strong>💡 ヒント：</strong>CSVファイルはExcelで開けますが、データ入力規則などの機能を使うには<strong>必ずExcel形式（.xlsx）で保存</strong>してください。</p>
        </div>
    </div>

    <script>
        function showStatus(message) {
            var statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.classList.add('show');
        }

        function appendStatus(message) {
            var statusDiv = document.getElementById('status');
            statusDiv.textContent += '\n' + message;
        }

        function downloadFile(content, filename, type) {
            var bom = '\uFEFF';
            var blob = new Blob([bom + content], { type: type + ';charset=utf-8;' });
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            URL.revokeObjectURL(link.href);
        }

        function generateExcel() {
            showStatus('Excelファイルを生成中...');

            var addressBookHeaders = [
                'チェック', '分類', '姓名', '名前', '姓名よみ', '名前よみ', '連名',
                '郵便番号1', '郵便番号2', '都道府県', '住所1', '住所2',
                '電話番号1', '電話番号2', '電子メール', 'メモ',
                '年賀状1(2026)', '年賀状2(2026)', '年賀状3(2025)', '年賀状4(2025)',
                '年賀状5(2024)', '年賀状6(2024)', '年賀状7(2023)', '年賀状8(2023)'
            ];

            var sampleData = [
                ['▲', '友人', '山田', '太郎', 'やまだ', 'たろう', '', '100', '0001', '東京都', '千代田区丸の内1-1-1', '', '03-1234-5678', '', 'yamada@example.com', 'サンプルデータ1', '', '受取', '', '', '', '', '', ''],
                ['', '親戚', '佐藤', '花子', 'さとう', 'はなこ', '一郎', '150', '0001', '東京都', '渋谷区神宮前1-1-1', 'マンション101', '090-1234-5678', '', '', '親戚の佐藤さん', '', '', '', '', '', '', '', ''],
                ['▲', '会社', '鈴木', '次郎', 'すずき', 'じろう', '', '530', '0001', '大阪府', '大阪市北区梅田1-1-1', '梅田ビル5F', '06-1234-5678', '06-9876-5432', 'suzuki@company.co.jp', '会社の上司', '', '受取', '', '受取', '', '', '', '']
            ];

            var csvContent = addressBookHeaders.join(',') + '\n';
            for (var i = 0; i < sampleData.length; i++) {
                var row = sampleData[i];
                var cells = [];
                for (var j = 0; j < row.length; j++) {
                    cells.push('"' + row[j] + '"');
                }
                csvContent += cells.join(',') + '\n';
            }

            for (var i = 0; i < 20; i++) {
                var emptyCells = [];
                for (var j = 0; j < 24; j++) {
                    emptyCells.push('""');
                }
                csvContent += emptyCells.join(',') + '\n';
            }

            downloadFile(csvContent, '住所録.csv', 'text/csv');
            appendStatus('✓ 住所録.csv をダウンロードしました');

            setTimeout(function() {
                var senderData = [
                    ['項目', '内容'],
                    ['郵便番号1(3桁)', '123'],
                    ['郵便番号2(4桁)', '4567'],
                    ['都道府県', '東京都'],
                    ['住所1', '渋谷区〇〇1-2-3'],
                    ['住所2', ''],
                    ['姓名', '山田'],
                    ['名前', '太郎'],
                    ['差出人印刷', 'する']
                ];

                var senderCsv = '';
                for (var i = 0; i < senderData.length; i++) {
                    var row = senderData[i];
                    senderCsv += '"' + row[0] + '","' + row[1] + '"\n';
                }
                
                downloadFile(senderCsv, '差出人情報.csv', 'text/csv');
                appendStatus('✓ 差出人情報.csv をダウンロードしました');
            }, 500);
        }

        function generateWordInstructions() {
            var instructions = '年賀状宛名印刷 - Word差し込み印刷 設定手順書\n\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n' +
'【準備】\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n' +
'1. 「住所録.csv」をExcelで開き、「名前を付けて保存」で\n' +
'   「住所録.xlsx」（Excel形式）として保存してください。\n\n' +
'2. データ入力規則の設定：\n\n' +
'   A列（チェック）：\n' +
'   - セルA2を選択 → データタブ → データの入力規則\n' +
'   - 入力値の種類：リスト\n' +
'   - 元の値：,▲  ※カンマと▲を入力\n' +
'   - 空白を無視にチェック → OK\n' +
'   - A2セルをコピーして、A3以降にも貼り付け\n\n' +
'   B列（分類）：\n' +
'   - セルB2を選択 → データの入力規則\n' +
'   - 元の値：友人,親戚,会社,賀状終了,ご逝去\n' +
'   - B2セルをコピーして、B3以降にも貼り付け\n\n' +
'   Q,S,U,W列（年賀状送付記録）：\n' +
'   - セルQ2,S2,U2,W2を選択 → データの入力規則\n' +
'   - 元の値：,出さない,喪中\n' +
'   - コピーして下の行にも貼り付け\n\n' +
'   R,T,V,X列（年賀状受取記録）：\n' +
'   - セルR2,T2,V2,X2を選択 → データの入力規則\n' +
'   - 元の値：,受取\n' +
'   - コピーして下の行にも貼り付け\n\n' +
'3. 住所録データを入力してください。\n\n\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n' +
'【Word差し込み印刷の設定手順】\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n' +
'■ステップ1：Wordで新規文書を作成\n\n' +
'1. Wordを起動し、新規文書を作成\n' +
'2. レイアウトタブ → サイズ → その他の用紙サイズ\n' +
'   - 幅：10cm（100mm）\n' +
'   - 高さ：14.8cm（148mm）\n' +
'   - OK\n' +
'3. レイアウトタブ → 印刷の向き → 縦\n' +
'4. レイアウトタブ → 余白 → 狭い\n\n\n' +
'■ステップ2：差し込み印刷の設定\n\n' +
'1. 差し込み文書タブ → 「差し込み印刷の開始」 → 「レター」\n' +
'2. 差し込み文書タブ → 「宛先の選択」 → 「既存のリストを使用」\n' +
'3. 「住所録.xlsx」を選択 → Sheet1を選択 → OK\n' +
'4. 差し込み文書タブ → 「結果のプレビュー」にチェック\n\n\n' +
'■ステップ3：フィルター設定（重要！）\n\n' +
'1. 差し込み文書タブ → 「宛先の編集」\n' +
'2. 「フィルター」タブをクリック\n' +
'3. フィールド：チェック\n' +
'   比較：次の値に等しい\n' +
'   比較対象：▲\n' +
'4. OK → OK\n\n' +
'※これにより、チェック欄が「▲」の行のみ印刷されます\n\n\n' +
'■ステップ4：宛名レイアウトの作成\n\n' +
'【郵便番号（受取人）】\n' +
'位置：右上\n' +
'1. テキストボックスを挿入（挿入タブ → テキストボックス → 横書き）\n' +
'2. 差し込み文書タブ → 「差し込みフィールドの挿入」\n' +
'   <<郵便番号1>> - <<郵便番号2>>\n' +
'3. フォント：MSゴシック、サイズ：18pt\n' +
'4. 位置：右から2cm、上から1.5cm\n\n\n' +
'【住所（受取人）】\n' +
'位置：右側\n' +
'1. 縦書きテキストボックスを挿入\n' +
'2. 差し込みフィールドを挿入：\n' +
'   <<都道府県>><<住所1>>\n' +
'   改行\n' +
'   <<住所2>>\n' +
'3. フォント：MS明朝、サイズ：14pt\n' +
'4. 位置：右から3.5cm、上から4cm\n\n\n' +
'【宛名（受取人）】\n' +
'位置：中央やや右\n' +
'1. 縦書きテキストボックスを挿入\n' +
'2. 差し込みフィールドを挿入：\n' +
'   <<姓名>>　<<名前>>　様\n' +
'3. 連名がある場合の処理：\n' +
'   - 「ルールの挿入」→「IF...THEN...ELSE」\n' +
'   - フィールド名：連名\n' +
'   - 比較：次の値に等しくない\n' +
'   - 比較対象：（空白）\n' +
'   - 次の文字列を挿入：\n' +
'     <<姓名>>　<<名前>>　様\n' +
'     <<連名>>　様\n' +
'   - それ以外の場合：\n' +
'     <<姓名>>　<<名前>>　様\n' +
'4. フォント：MS明朝、サイズ：20pt（名前は大きめに）\n' +
'5. 位置：右から6cm、上から6cm\n\n\n' +
'【郵便番号（差出人）】\n' +
'位置：左下\n' +
'1. テキストボックスを挿入\n' +
'2. Excelの「差出人情報.xlsx」から手動で入力\n' +
'3. フォント：MSゴシック、サイズ：12pt\n' +
'4. 位置：左から1cm、下から3.5cm\n\n\n' +
'【住所（差出人）】\n' +
'位置：左下\n' +
'1. 縦書きテキストボックスを挿入\n' +
'2. 差出人情報を入力\n' +
'3. フォント：MS明朝、サイズ：10pt\n' +
'4. 位置：左から2.5cm、下から3.5cm\n\n\n' +
'【氏名（差出人）】\n' +
'位置：左下\n' +
'1. 縦書きテキストボックスを挿入\n' +
'2. 差出人の氏名を入力\n' +
'3. フォント：MS明朝、サイズ：12pt\n' +
'4. 位置：左から4cm、下から3.5cm\n\n\n' +
'■ステップ5：印刷プレビューと印刷\n\n' +
'1. 差し込み文書タブ → 「結果のプレビュー」\n' +
'2. レコード移動ボタン（< >）で各宛名を確認\n' +
'3. 差し込み文書タブ → 「完了と差し込み」\n' +
'   - 「文書の印刷」を選択\n' +
'   - すべてのレコードを印刷\n' +
'4. はがき用紙をプリンターにセット\n' +
'5. 印刷\n\n\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n' +
'【便利な機能】\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n' +
'■複数条件でのフィルター：\n' +
'「宛先の編集」→「フィルター」で複数条件を設定可能\n' +
'例）チェックが▲ AND 分類が「友人」\n\n\n' +
'■並び替え：\n' +
'「宛先の編集」→「並べ替え」\n' +
'例）分類 → 姓名よみ の順で並び替え\n\n\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n' +
'【トラブルシューティング】\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n' +
'Q: 郵便番号の先頭の0が消える\n' +
'A: Excelで郵便番号の列を選択 → セルの書式設定 → \n' +
'   表示形式「文字列」に変更\n\n' +
'Q: 連名が表示されない\n' +
'A: IFフィールドの設定を確認\n\n' +
'Q: 印刷位置がずれる\n' +
'A: テキストボックスの位置を調整。試し印刷で確認\n\n\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n' +
'以上で設定完了です。素敵な年賀状をお送りください！\n' +
'━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━';

            downloadFile(instructions, 'Word差し込み印刷_設定手順書.txt', 'text/plain');
            appendStatus('✓ Word設定手順書をダウンロードしました');
        }
    </script>
</body>
</html>